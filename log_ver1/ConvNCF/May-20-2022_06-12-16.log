Fri 20 May 2022 06:12:16 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = /opt/ml/workspace/RecBole/dataset/whiskey
checkpoint_dir = /opt/ml/workspace/RecBole/model_saved
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 300
train_batch_size = 64
learner = adam
learning_rate = 0.001
neg_sampling = {'popularity': 10}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}
repeatable = False
metrics = ['Recall', 'NDCG']
topk = [5, 10]
valid_metric = NDCG@10
valid_metric_bigger = True
eval_batch_size = 256
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user
ITEM_ID_FIELD = whiskey
RATING_FIELD = rating
TIME_FIELD = None
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user', 'whiskey', 'rating']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = {'rating': '[0,100]'}
filter_inter_by_user_or_item = True
user_inter_num_interval = [5,inf)
item_inter_num_interval = [5,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
wandb_project = recbole_whiskey
require_pow = False
embedding_size = 64
cnn_channels = [1, 32, 32, 32, 32]
cnn_kernels = [4, 4, 2, 2]
cnn_strides = [4, 4, 2, 2]
dropout_prob = 0.2
reg_weights = [0.1, 0.1]
MODEL_TYPE = ModelType.GENERAL
MODEL_INPUT_TYPE = InputType.PAIRWISE
eval_type = EvaluatorType.RANKING
device = cuda
train_neg_sample_args = {'strategy': 'by', 'by': 10, 'distribution': 'popularity', 'dynamic': 'none'}
eval_neg_sample_args = {'strategy': 'full', 'distribution': 'uniform'}


Fri 20 May 2022 06:12:16 INFO  whiskey
The number of users: 984
Average actions of users: 38.3001017293998
The number of items: 478
Average actions of items: 78.9287211740042
The number of inters: 37649
The sparsity of the dataset: 91.99556927577643%
Remain Fields: ['user', 'whiskey', 'rating']
Fri 20 May 2022 06:12:17 INFO  [Training]: train_batch_size = [64] negative sampling: [{'popularity': 10}]
Fri 20 May 2022 06:12:17 INFO  [Evaluation]: eval_batch_size = [256] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'group_by': 'user', 'order': 'RO', 'mode': 'full'}]
Fri 20 May 2022 06:12:19 INFO  ConvNCF(
  (user_embedding): Embedding(984, 64)
  (item_embedding): Embedding(478, 64)
  (cnn_layers): CNNLayers(
    (cnn_layers): Sequential(
      (0): Conv2d(1, 32, kernel_size=(4, 4), stride=(4, 4))
      (1): ReLU()
      (2): Conv2d(32, 32, kernel_size=(4, 4), stride=(4, 4))
      (3): ReLU()
      (4): Conv2d(32, 32, kernel_size=(2, 2), stride=(2, 2))
      (5): ReLU()
      (6): Conv2d(32, 32, kernel_size=(2, 2), stride=(2, 2))
      (7): ReLU()
    )
  )
  (predict_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.2, inplace=False)
      (1): Linear(in_features=32, out_features=1, bias=True)
    )
  )
  (loss): ConvNCFBPRLoss()
)
Trainable parameters: 118817
Fri 20 May 2022 06:14:03 INFO  epoch 0 training [time: 103.89s, train loss: 317671.3199]
Fri 20 May 2022 06:14:12 INFO  epoch 0 evaluating [time: 9.14s, valid_score: 0.119300]
Fri 20 May 2022 06:14:12 INFO  valid result: 
recall@5 : 0.0849    recall@10 : 0.1114    ndcg@5 : 0.1295    ndcg@10 : 0.1193
Fri 20 May 2022 06:14:12 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:15:55 INFO  epoch 1 training [time: 102.89s, train loss: 252469.3889]
Fri 20 May 2022 06:16:04 INFO  epoch 1 evaluating [time: 9.13s, valid_score: 0.158800]
Fri 20 May 2022 06:16:04 INFO  valid result: 
recall@5 : 0.1122    recall@10 : 0.1463    ndcg@5 : 0.1719    ndcg@10 : 0.1588
Fri 20 May 2022 06:16:04 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:17:48 INFO  epoch 2 training [time: 103.72s, train loss: 212427.1891]
Fri 20 May 2022 06:17:57 INFO  epoch 2 evaluating [time: 9.17s, valid_score: 0.189800]
Fri 20 May 2022 06:17:57 INFO  valid result: 
recall@5 : 0.1519    recall@10 : 0.1873    ndcg@5 : 0.2036    ndcg@10 : 0.1898
Fri 20 May 2022 06:17:57 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:19:41 INFO  epoch 3 training [time: 103.79s, train loss: 179975.8559]
Fri 20 May 2022 06:19:50 INFO  epoch 3 evaluating [time: 9.06s, valid_score: 0.203100]
Fri 20 May 2022 06:19:50 INFO  valid result: 
recall@5 : 0.1521    recall@10 : 0.1947    ndcg@5 : 0.2168    ndcg@10 : 0.2031
Fri 20 May 2022 06:19:50 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:21:34 INFO  epoch 4 training [time: 103.53s, train loss: 156901.7456]
Fri 20 May 2022 06:21:43 INFO  epoch 4 evaluating [time: 9.26s, valid_score: 0.205500]
Fri 20 May 2022 06:21:43 INFO  valid result: 
recall@5 : 0.1577    recall@10 : 0.1982    ndcg@5 : 0.2222    ndcg@10 : 0.2055
Fri 20 May 2022 06:21:43 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:23:28 INFO  epoch 5 training [time: 104.45s, train loss: 139720.1268]
Fri 20 May 2022 06:23:37 INFO  epoch 5 evaluating [time: 9.24s, valid_score: 0.214600]
Fri 20 May 2022 06:23:37 INFO  valid result: 
recall@5 : 0.1646    recall@10 : 0.1972    ndcg@5 : 0.235    ndcg@10 : 0.2146
Fri 20 May 2022 06:23:37 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:25:20 INFO  epoch 6 training [time: 103.34s, train loss: 126890.2959]
Fri 20 May 2022 06:25:29 INFO  epoch 6 evaluating [time: 9.09s, valid_score: 0.213000]
Fri 20 May 2022 06:25:29 INFO  valid result: 
recall@5 : 0.1636    recall@10 : 0.2021    ndcg@5 : 0.2308    ndcg@10 : 0.213
Fri 20 May 2022 06:27:13 INFO  epoch 7 training [time: 103.59s, train loss: 117166.3107]
Fri 20 May 2022 06:27:22 INFO  epoch 7 evaluating [time: 9.07s, valid_score: 0.218500]
Fri 20 May 2022 06:27:22 INFO  valid result: 
recall@5 : 0.1679    recall@10 : 0.2049    ndcg@5 : 0.239    ndcg@10 : 0.2185
Fri 20 May 2022 06:27:22 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:29:06 INFO  epoch 8 training [time: 103.76s, train loss: 109901.8390]
Fri 20 May 2022 06:29:15 INFO  epoch 8 evaluating [time: 9.09s, valid_score: 0.219100]
Fri 20 May 2022 06:29:15 INFO  valid result: 
recall@5 : 0.1713    recall@10 : 0.2071    ndcg@5 : 0.2383    ndcg@10 : 0.2191
Fri 20 May 2022 06:29:15 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:30:58 INFO  epoch 9 training [time: 103.67s, train loss: 103846.9760]
Fri 20 May 2022 06:31:08 INFO  epoch 9 evaluating [time: 9.29s, valid_score: 0.217800]
Fri 20 May 2022 06:31:08 INFO  valid result: 
recall@5 : 0.1688    recall@10 : 0.2081    ndcg@5 : 0.2355    ndcg@10 : 0.2178
Fri 20 May 2022 06:32:51 INFO  epoch 10 training [time: 103.35s, train loss: 99764.3622]
Fri 20 May 2022 06:33:00 INFO  epoch 10 evaluating [time: 9.04s, valid_score: 0.225400]
Fri 20 May 2022 06:33:00 INFO  valid result: 
recall@5 : 0.1777    recall@10 : 0.2052    ndcg@5 : 0.2515    ndcg@10 : 0.2254
Fri 20 May 2022 06:33:00 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:34:43 INFO  epoch 11 training [time: 102.92s, train loss: 95943.7829]
Fri 20 May 2022 06:34:52 INFO  epoch 11 evaluating [time: 9.12s, valid_score: 0.234700]
Fri 20 May 2022 06:34:52 INFO  valid result: 
recall@5 : 0.1806    recall@10 : 0.2192    ndcg@5 : 0.2556    ndcg@10 : 0.2347
Fri 20 May 2022 06:34:52 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:36:36 INFO  epoch 12 training [time: 103.81s, train loss: 93015.8841]
Fri 20 May 2022 06:36:45 INFO  epoch 12 evaluating [time: 9.17s, valid_score: 0.220100]
Fri 20 May 2022 06:36:45 INFO  valid result: 
recall@5 : 0.1647    recall@10 : 0.2053    ndcg@5 : 0.2397    ndcg@10 : 0.2201
Fri 20 May 2022 06:38:28 INFO  epoch 13 training [time: 103.24s, train loss: 90734.6781]
Fri 20 May 2022 06:38:38 INFO  epoch 13 evaluating [time: 9.14s, valid_score: 0.237100]
Fri 20 May 2022 06:38:38 INFO  valid result: 
recall@5 : 0.1838    recall@10 : 0.2237    ndcg@5 : 0.2573    ndcg@10 : 0.2371
Fri 20 May 2022 06:38:38 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:40:21 INFO  epoch 14 training [time: 103.61s, train loss: 88638.6018]
Fri 20 May 2022 06:40:30 INFO  epoch 14 evaluating [time: 9.12s, valid_score: 0.225600]
Fri 20 May 2022 06:40:30 INFO  valid result: 
recall@5 : 0.1682    recall@10 : 0.2135    ndcg@5 : 0.2434    ndcg@10 : 0.2256
Fri 20 May 2022 06:42:14 INFO  epoch 15 training [time: 103.37s, train loss: 86669.0929]
Fri 20 May 2022 06:42:23 INFO  epoch 15 evaluating [time: 9.22s, valid_score: 0.229900]
Fri 20 May 2022 06:42:23 INFO  valid result: 
recall@5 : 0.1726    recall@10 : 0.2178    ndcg@5 : 0.2496    ndcg@10 : 0.2299
Fri 20 May 2022 06:44:05 INFO  epoch 16 training [time: 102.61s, train loss: 85157.0888]
Fri 20 May 2022 06:44:15 INFO  epoch 16 evaluating [time: 9.09s, valid_score: 0.231300]
Fri 20 May 2022 06:44:15 INFO  valid result: 
recall@5 : 0.1745    recall@10 : 0.2098    ndcg@5 : 0.2543    ndcg@10 : 0.2313
Fri 20 May 2022 06:45:58 INFO  epoch 17 training [time: 103.84s, train loss: 83568.6782]
Fri 20 May 2022 06:46:08 INFO  epoch 17 evaluating [time: 9.20s, valid_score: 0.228300]
Fri 20 May 2022 06:46:08 INFO  valid result: 
recall@5 : 0.1695    recall@10 : 0.2121    ndcg@5 : 0.2475    ndcg@10 : 0.2283
Fri 20 May 2022 06:47:51 INFO  epoch 18 training [time: 103.45s, train loss: 81733.9725]
Fri 20 May 2022 06:48:00 INFO  epoch 18 evaluating [time: 9.15s, valid_score: 0.232100]
Fri 20 May 2022 06:48:00 INFO  valid result: 
recall@5 : 0.1814    recall@10 : 0.2211    ndcg@5 : 0.252    ndcg@10 : 0.2321
Fri 20 May 2022 06:49:44 INFO  epoch 19 training [time: 103.37s, train loss: 80896.7742]
Fri 20 May 2022 06:49:53 INFO  epoch 19 evaluating [time: 9.01s, valid_score: 0.235700]
Fri 20 May 2022 06:49:53 INFO  valid result: 
recall@5 : 0.1807    recall@10 : 0.2194    ndcg@5 : 0.2568    ndcg@10 : 0.2357
Fri 20 May 2022 06:51:36 INFO  epoch 20 training [time: 103.63s, train loss: 79984.8566]
Fri 20 May 2022 06:51:45 INFO  epoch 20 evaluating [time: 9.01s, valid_score: 0.228500]
Fri 20 May 2022 06:51:45 INFO  valid result: 
recall@5 : 0.1785    recall@10 : 0.2121    ndcg@5 : 0.2507    ndcg@10 : 0.2285
Fri 20 May 2022 06:53:28 INFO  epoch 21 training [time: 102.92s, train loss: 78962.1489]
Fri 20 May 2022 06:53:37 INFO  epoch 21 evaluating [time: 9.07s, valid_score: 0.243000]
Fri 20 May 2022 06:53:37 INFO  valid result: 
recall@5 : 0.1911    recall@10 : 0.2244    ndcg@5 : 0.2656    ndcg@10 : 0.243
Fri 20 May 2022 06:53:37 INFO  Saving current: /opt/ml/workspace/RecBole/model_saved/ConvNCF-May-20-2022_06-12-19.pth
Fri 20 May 2022 06:55:20 INFO  epoch 22 training [time: 103.20s, train loss: 78134.0286]
Fri 20 May 2022 06:55:30 INFO  epoch 22 evaluating [time: 9.05s, valid_score: 0.240300]
Fri 20 May 2022 06:55:30 INFO  valid result: 
recall@5 : 0.1883    recall@10 : 0.2264    ndcg@5 : 0.2634    ndcg@10 : 0.2403
Fri 20 May 2022 06:57:11 INFO  epoch 23 training [time: 101.53s, train loss: 77208.0567]
Fri 20 May 2022 06:57:20 INFO  epoch 23 evaluating [time: 8.92s, valid_score: 0.220300]
Fri 20 May 2022 06:57:20 INFO  valid result: 
recall@5 : 0.1682    recall@10 : 0.209    ndcg@5 : 0.238    ndcg@10 : 0.2203
Fri 20 May 2022 06:59:03 INFO  epoch 24 training [time: 102.60s, train loss: 77161.0589]
Fri 20 May 2022 06:59:12 INFO  epoch 24 evaluating [time: 8.94s, valid_score: 0.233400]
Fri 20 May 2022 06:59:12 INFO  valid result: 
recall@5 : 0.1813    recall@10 : 0.2187    ndcg@5 : 0.2542    ndcg@10 : 0.2334
Fri 20 May 2022 07:00:53 INFO  epoch 25 training [time: 101.50s, train loss: 76191.2482]
Fri 20 May 2022 07:01:02 INFO  epoch 25 evaluating [time: 8.86s, valid_score: 0.226600]
Fri 20 May 2022 07:01:02 INFO  valid result: 
recall@5 : 0.1743    recall@10 : 0.2124    ndcg@5 : 0.2464    ndcg@10 : 0.2266
Fri 20 May 2022 07:02:43 INFO  epoch 26 training [time: 101.40s, train loss: 75281.6642]
Fri 20 May 2022 07:02:52 INFO  epoch 26 evaluating [time: 9.05s, valid_score: 0.232900]
Fri 20 May 2022 07:02:52 INFO  valid result: 
recall@5 : 0.1757    recall@10 : 0.2182    ndcg@5 : 0.2514    ndcg@10 : 0.2329
Fri 20 May 2022 07:04:35 INFO  epoch 27 training [time: 102.26s, train loss: 75064.2264]
Fri 20 May 2022 07:04:44 INFO  epoch 27 evaluating [time: 8.92s, valid_score: 0.231300]
Fri 20 May 2022 07:04:44 INFO  valid result: 
recall@5 : 0.1798    recall@10 : 0.2158    ndcg@5 : 0.2528    ndcg@10 : 0.2313
